{% include 'header.html' %}
{% load static %}
<section id="searchdoctor" xmlns="http://www.w3.org/1999/html">
    <div class="container">
        <div class="innerwrap">
            <div class="row">
                <div class="col-md-3">
                    <input type="search" id="autocomplete" class="form-controls" placeholder="Select city"/>
                </div>
                <div class="col-md-4">
                    <section id="getdirectionmap">
                        <div class="getdirectionmap">
                            <form id="location-mapform">

                                <input type="text" id="txtSource" placeholder="Enter your location"
                                       style="width: 100%"/>

                            </form>
                        </div>
                    </section>
                </div>
                <div class="col-md-4">
                    <input type="search" class="form-controls" placeholder="Specilist/Doctor/Clinic/Hospital"/>
                </div>
                <div class="col-md-1">
                    <button type="button" class="custombtn">Search</button>
                </div>
            </div>
            <div class="row">
                <div class="col-md-3">
                    <div class="filterwrap">
                        <h4>Availability</h4>
                        <div class="filterheading">
                            <p><input name="Availability" type="radio"><span class="shortname">Today</span></p>
                            <p><input name="Availability" type="radio"><span class="shortname">Tomorrow</span></p>
                            <p><span class="any">Any</span>
                            <div class="days">
                                <a href="">S</a>
                                <a href="">M</a>
                                <a href="">T</a>
                                <a href="">W</a>
                                <a href="">T</a>
                                <a href="">F</a>
                                <a href="">S</a>
                            </div>
                            </p>
                        </div>
                    </div>
                    <div class="filterwrap">
                        <h4>Gender</h4>
                        <div class="filterheading">
                            <p><input name="gender" type="radio"><span class="shortname">Any Gender</span></p>
                            <p><input name="gender" type="radio"><span class="shortname">Male</span></p>
                            <p><input name="gender" type="radio"><span class="shortname">Female</span></p>
                        </div>
                    </div>
                    <div class="filterwrap">
                        <h4>Distance</h4>
                        <div class="filterheading">
                            <p><input name="distance" type="radio"><span class="shortname">Near by me</span></p>
                            <p><input name="distance" type="radio"><span class="shortname">Under 10km</span></p>
                            <p><input name="distance" type="radio"><span class="shortname">Under 30km</span></p>
                        </div>
                    </div>
                    <div class="filterwrap">
                        <h4>Consultancy Fees</h4>
                        <div class="filterheading">
                            <p><input name="Speciality" type="radio"><span class="shortname">Free</span></p>
                            <p><input name="Speciality" type="radio"><span class="shortname">Rs.100 - Rs.500</span></p>
                            <p><input name="Speciality" type="radio"><span class="shortname">Rs.500+</span></p>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">

                    {% for doctor_list in doctor_list %}
                    <div class="innerwrap listdoctor">
                        <div class="row">
                            <div class="col-md-2">
                                {% if doctor_list.pic %}
                                <img src="../uploads/{{doctor_list.pic}}" class="img-responsive" alt="">
                                {% else %}
                                <img src="{% static '' %}images/doctor-profile.jpg" class="img-responsive" alt="">
                                {% endif %}


                            </div>
                            <div class="col-md-5">
                                <a href="../doctordetail/{{doctor_list.doctor_profile_id.username}}" class="doctor-profile-img"><h1>Dr. {{doctor_list.doctor_profile_id.first_name}}
                                    {{doctor_list.doctor_profile_id.last_name}}</h1></a>
                                <p class="specialist">{{doctor_list.uexperience02}} </p>
                                <p class="clinicaddress">{{doctor_list.selectcity}}<br>{{doctor_list.state}}</p>
                                <div class="clinic smallclinicimg">
                                    <p></p>



                                    <section class="img-gallery-magnific" id="searchprofile">


                                            <div class="row nopadd">
                                                {% for clinic_pic in pic_list %}
                                                {% if clinic_pic.doctor_profile_id.id == doctor_list.doctor_profile_id.id %}
                                                <div class="col-md-3">
                                                     <div class="magnific-img ">
                                                        <a class="image-popup-vertical-fit" href="../uploads/{{clinic_pic.Cphotos1}}"
                                                           title="{{clinic_pic.clinic_id.Cname}}">
                                                            <img src="../uploads/{{clinic_pic.Cphotos1}}" alt="">
                                                        </a>
                                                    </div>
                                                </div>
                                                 <div class="col-md-3">
                                                    <div class="magnific-img fullwidth">
                                                        <a class="image-popup-vertical-fit" href="../uploads/{{clinic_pic.Cphotos2}}"
                                                           title="{{clinic_pic.clinic_id.Cname}}">
                                                            <img src="../uploads/{{clinic_pic.Cphotos2}}" alt="9.jpg">
                                                        </a>
                                                    </div>
                                                 </div>
                                                 <div class="col-md-3">
                                                    <div class="magnific-img fullwidth">
                                                        <a class="image-popup-vertical-fit" href="../uploads/{{clinic_pic.Cphotos3}}"
                                                           title="{{clinic_pic.clinic_id.Cname}}">
                                                            <img src="../uploads/{{clinic_pic.Cphotos3}}" alt="9.jpg">
                                                        </a>
                                                    </div>
                                                 </div>
                                                 <div class="col-md-3">
                                                    <div class="magnific-img fullwidth">
                                                        <a class="image-popup-vertical-fit" href="../uploads/{{clinic_pic.Cphotos4}}"
                                                           title="{{clinic_pic.clinic_id.Cname}}">
                                                            <img src="../uploads/{{clinic_pic.Cphotos4}}" alt="9.jpg">
                                                        </a>
                                                    </div>
                                                </div>
                                                {% endif %}
                                            {% endfor %}
                                            </div>

                                    </section>




                                    <div class="clear"></div>
                                    <p></p>
                                </div>
                            </div>
                            <div class="col-md-5">
                                <div class="doctor_detail">
                                    <table class="table table-primary">
                                        <tbody>

                                        <tr>
                                            <td><i class="fa fa-commenting-o" aria-hidden="true"></i></td>
                                            <td id="feed{{doctor_list.id}}"> </td>
                                        </tr>
                                        <tr>
                                            <td><i class="fa fa-user-md" aria-hidden="true"></i></td>
                                            <td>{{doctor_list.uexperience01}} Years experience</td>
                                        </tr>
                                        <tr>
                                            <td><i class="fa fa-graduation-cap" aria-hidden="true"></i></td>
                                            <td>{{doctor_list.selectdegree}}</td>
                                        </tr>
                                        <tr>
                                            <td><i class="fa fa-thumbs-o-up" aria-hidden="true"></i></td>
                                            <td id="apendrating{{doctor_list.id}}" class="ratingstar">

                                            </td>
                                           <script>
                                            var rating5 =0;
                                            var rating4 =0;
                                            var rating3 =0;
                                            var rating2 =0;
                                            var rating1 =0;
                                            var total =0;
                                            var review_list_avrage =0;
                                            {% for review_list in review_list  %}
                                            {% if review_list.doctor_profile_id.id == doctor_list.doctor_profile_id.id %}
                                                   total +=1;
                                                  {% if review_list.rating1 == '5' %}
                                                   rating5 += 1;
                                                  {% endif %}
                                                  {% if review_list.rating1 == '4' %}
                                                     rating4 += 1;
                                                  {% endif %}
                                                  {% if review_list.rating1 == '3' %}
                                                    rating3 += 1;
                                                  {% endif %}
                                                  {% if review_list.rating1 == '2' %}
                                                    rating2 += 1;
                                                  {% endif %}
                                                  {% if review_list.rating1 == '1' %}
                                                    rating1 += 1;
                                                  {% endif %}
                                            {% endif %}
                                            {% endfor %}
                                             review_list_avrage = (5 * rating5 + 4 * rating4 + 3 * rating3 + 2 * rating2 + 1 * rating1) / total;
                                             total = total+ " Feedback";
                                             $("#feed{{doctor_list.id}}").append(total);
                                             var myTrunc = Math.trunc( review_list_avrage );
                                            if(myTrunc == 5){
                                            x= '<span class="fa fa-star checked"></span><span class="fa fa-star checked"></span><span class="fa fa-star checked"></span><span class="fa fa-star checked"></span><span class="fa fa-star checked"></span>';
                                             $("#apendrating{{doctor_list.id}}").append(x);
                                            }
                                            else if (myTrunc == 4){
                                             x= '<span class="fa fa-star checked"></span><span class="fa fa-star checked"></span><span class="fa fa-star checked"></span><span class="fa fa-star checked"></span><span class="fa fa-star "></span>';
                                             $("#apendrating{{doctor_list.id}}").append(x);
                                            }
                                            else if (myTrunc == 3){
                                            x= '<span class="fa fa-star checked"></span><span class="fa fa-star checked"></span><span class="fa fa-star checked"></span><span class="fa fa-star "></span><span class="fa fa-star "></span>';
                                             $("#apendrating{{doctor_list.id}}").append(x);
                                            }
                                            else if (myTrunc == 2){
                                             x= '<span class="fa fa-star checked"></span><span class="fa fa-star checked"></span><span class="fa fa-star "></span><span class="fa fa-star "></span><span class="fa fa-star "></span>';
                                             $("#apendrating{{doctor_list.id}}").append(x);
                                            }
                                            else if (myTrunc == 1){
                                            x= '<span class="fa fa-star checked"></span><span class="fa fa-star "></span><span class="fa fa-star "></span><span class="fa fa-star "></span><span class="fa fa-star "></span>';
                                             $("#apendrating{{doctor_list.id}}").append(x);
                                            }
                                            else{
                                             x= '<span class="fa fa-star "></span><span class="fa fa-star "></span><span class="fa fa-star "></span><span class="fa fa-star "></span><span class="fa fa-star "></span>';
                                             $("#apendrating{{doctor_list.id}}").append(x);

                                            }
                                             </script>

                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td> <span class="ratingbox">
                                                <i class="fa fa-check" aria-hidden="true" style="font-size:10px;"></i>
                                                <span class="smalltxt">Verified</span></span></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 nopadd2">
                                    <ul class="nav nav-tabs nav-justified">
                                        <li><a href="#">
                                           <i class="fa fa-phone" aria-hidden="true"></i>

                                            Call Clinic</a></li>
                                        <li><a href="../doctordetail/{{doctor_list.doctor_profile_id.username}}">
                                            <i class="fa fa-calendar-minus-o" aria-hidden="true"></i>

                                            Book Appointment</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    {% endfor %}


                </div>
                <div class="col-md-3 side">
                    <div class="filterwrap">
                        <h4>Related Specialities</h4>
                        <div class="filterheading">
                            <p><a href="#">Dermatologist </a></p>
                            <p><a href="#">Endocrinologist</a></p>
                            <p><a href="#">Aviation Medicine Specialist</a></p>
                            <p><a href="#">Endocrinologist </a></p>
                            <p><a href="#">Dermatologist</a></p>
                        </div>
                    </div>
                    <div class="filterwrap">
                        <h4>Top Health Tips</h4>
                        <div class="filterheading">
                            <p><a href="#">6 Best Home Remedies To Get Rid of Acne</a></p>
                            <p><a href="#">Acne Treatment With Alternative Medicine</a></p>
                            <p><a href="#">Do Birth Control Pills Help in Controlling Acne?</a></p>
                            <p><a href="#">All About Acne</a></p>
                            <p><a href="#">Pimples - 6 Common Homeopathic Remedies!</a></p>
                        </div>
                    </div>
                    <div class="askquestion">
                        <div class="filterheading">
                            <img src="{% static '' %}images/email.png" class="emailimg"/><h4>Ask s <b>FREE</b> Question
                        </h4>
                            <form>
                                <textarea placeholder="Enter a Question for You or Something Else...."
                                          required></textarea>
                                <input type="submit" class="custombtn" value="Submit"/>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
</section>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false&libraries=places"></script>
<script type="text/javascript">
var source, destination;
var directionsDisplay;
var directionsService = new google.maps.DirectionsService();
google.maps.event.addDomListener(window, 'load', function () {
    new google.maps.places.SearchBox(document.getElementById('txtSource'));
    new google.maps.places.SearchBox(document.getElementById('txtDestination'));
    directionsDisplay = new google.maps.DirectionsRenderer({ 'draggable': true });
});
function GetRoute() {
    var mumbai = new google.maps.LatLng(18.9750, 72.8258);
    var mapOptions = {
        zoom: 7,
        center: mumbai
    };
    map = new google.maps.Map(document.getElementById('dvMap'), mapOptions);
    directionsDisplay.setMap(map);
    directionsDisplay.setPanel(document.getElementById('dvPanel'));
    source = document.getElementById("txtSource").value;
    destination = document.getElementById("txtDestination").value;
    var request = {
        origin: source,
        destination: destination,
        travelMode: google.maps.TravelMode.DRIVING
    };
    directionsService.route(request, function (response, status) {
        if (status == google.maps.DirectionsStatus.OK) {
            directionsDisplay.setDirections(response);
        }
    });
    var service = new google.maps.DistanceMatrixService();
    service.getDistanceMatrix({
        origins: [source],
        destinations: [destination],
        travelMode: google.maps.TravelMode.DRIVING,
        unitSystem: google.maps.UnitSystem.METRIC,
        avoidHighways: false,
        avoidTolls: false
    }, function (response, status) {
        if (status == google.maps.DistanceMatrixStatus.OK && response.rows[0].elements[0].status != "ZERO_RESULTS") {
            var distance = response.rows[0].elements[0].distance.text;
            var duration = response.rows[0].elements[0].duration.text;
            var dvDistance = document.getElementById("dvDistance");
            dvDistance.innerHTML = "";
            dvDistance.innerHTML += "Distance: " + distance + "<br />";
            dvDistance.innerHTML += "Duration:" + duration;

        } else {
            alert("Unable to find the distance via road.");
        }
    });
}


</script>
<script type="text/javascript" charset="utf-8">
$(document).ready(function() {
 var currgeocoder;
 navigator.geolocation.getCurrentPosition(function(position, html5Error) {
     geo_loc = processGeolocationResult(position);
     currLatLong = geo_loc.split(",");
     initializeCurrent(currLatLong[0], currLatLong[1]);
     $("#latlong").text(currLatLong);
});
function processGeolocationResult(position) {
     html5Lat = position.coords.latitude; //Get latitude
     html5Lon = position.coords.longitude; //Get longitude
     html5TimeStamp = position.timestamp; //Get timestamp
     html5Accuracy = position.coords.accuracy; //Get accuracy in meters
     return (html5Lat).toFixed(8) + ", " + (html5Lon).toFixed(8);
}
function initializeCurrent(latcurr, longcurr) {
     currgeocoder = new google.maps.Geocoder();
     console.log(latcurr + "-- ######## --" + longcurr);
     if (latcurr != '' && longcurr != '') {
         var myLatlng = new google.maps.LatLng(latcurr, longcurr);
         return getCurrentAddress(myLatlng);
     }
}
 function getCurrentAddress(location) {
      currgeocoder.geocode({
          'location': location
    }, function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            //console.log(results[0]);
            var currentaddress = results[0].formatted_address;
            $("#txtSource").val(currentaddress);

        } else {
            alert('Geocode was not successful for the following reason: ' + status);
        }
    });
 }
});
</script>
<script src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places&language=en"></script>
<script>
      var input = document.getElementById('autocomplete');
      var autocomplete = new google.maps.places.Autocomplete(input);
</script>
{% include 'footer.html' %}